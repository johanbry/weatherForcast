(()=>{"use strict";var e;!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(e||(e={}));const t=(e,t)=>{const n=new Date(1e3*(e+t));let o=n.getUTCHours(),a=n.getUTCMinutes();return o=o<10?"0"+o:o,a=a<10?"0"+a:a,`${o}:${a}`},n=(e,t)=>{const n=new Date(1e3*(e+t)),o=n.getUTCFullYear();let a=n.getUTCMonth()+1,r=n.getUTCDate();return a=a<10?"0"+a:a,r=r<10?"0"+r:r,`${o}-${a}-${r}`},o=(t,n)=>{const o=new Date(1e3*(t+n)).getUTCDay();return e[o]},a=e=>Math.round(e);var r=function(e,t,n,o){return new(n||(n=Promise))((function(a,r){function c(e){try{s(o.next(e))}catch(e){r(e)}}function i(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((o=o.apply(e,t||[])).next())}))};const c=(e,n)=>r(void 0,void 0,void 0,(function*(){const o=`http://localhost:3000/api/weather/${e}/${n}?mode=weather`;try{const e=yield fetch(o),n=yield e.json(),r=n.weather[0].main,c=t(Date.now()/1e3,n.timezone);(e=>{const t=document.querySelector("#city"),n=document.querySelector("#localTime"),o=document.querySelector("#temperature"),a=document.querySelector("#weatherDescription");t.textContent=e.city,n.textContent=e.localTime,o.innerHTML=`${e.temperature.toString()}&#176`,a.textContent=e.weather})({city:n.name,localTime:c,temperature:a(n.main.temp),weather:n.weather[0].description}),((e,t)=>{let n="";document.querySelector(".current-weather");let o=!1,a=document.querySelector("video");a&&(o=!0),o||(a=document.createElement("video"));const r=document.querySelector("body");switch(a.innerHTML="",e){case"Thunderstorm":n="../../public/assets/videos/thunderstorm-304.mp4";break;case"Drizzle":case"Rain":n="../../public/assets/videos/rain-28236.mp4";break;case"Snow":n="../../public/assets/videos/snow-7090.mp4";break;case"Clear":n="../../public/assets/videos/sun-36816.mp4";break;case"Clouds":n="../../public/assets/videos/cloud-3186.mp4";break;default:n="../../public/assets/videos/mist-2166.mp4"}a.src=n,a.autoplay=!0,a.controls=!1,a.muted=!0,a.loop=!0,o||r.prepend(a)})(r)}catch(e){throw e}})),i=(e,o)=>r(void 0,void 0,void 0,(function*(){const r=`http://localhost:3000/api/weather/${e}/${o}?mode=forecast`;try{const e=yield fetch(r),o=yield e.json(),c=o.city.timezone,i=(n(Date.now()/1e3,c),s(o.list,c)),d=[];o.list.slice(0,8).forEach((e=>{d.push({localTime:t(e.dt,c),temperature:a(e.main.temp),weatherIcon:`http://openweathermap.org/img/wn/${e.weather[0].icon}@2x.png`,weatherDescription:e.weather[0].description})})),(e=>{const t=document.querySelector("#currentHours");t.innerHTML="",e.forEach((e=>{const n=document.createElement("div"),o=document.createElement("p"),a=document.createElement("img"),r=document.createElement("small");n.classList.add("weather-card"),o.textContent=e.localTime,a.src=e.weatherIcon,r.innerHTML=`${e.temperature.toString()}&#176`,a.setAttribute("alt",e.weatherDescription),n.append(o,a,r),t.appendChild(n)}))})(d),(e=>{const t=document.querySelector(".forecast"),n=document.createElement("small");n.innerHTML="5-days forecast weather",t.innerHTML="",t.append(n),e.forEach((e=>{const n=document.createElement("div"),o=document.createElement("p"),a=document.createElement("img"),r=document.createElement("p"),c=document.createElement("i");n.classList.add("forecast-overview-card"),c.classList.add("fa-solid","fa-chevron-down"),o.textContent=e.weekday,a.src=e.weatherIcon,r.innerHTML=`${e.minTemp.toString()}/${e.maxTemp.toString()}&#176`,a.setAttribute("alt",e.weatherDescription),n.append(o,a,r,c);const i=(e=>{const t=document.createElement("table"),n=document.createElement("tr");return t.classList.add("hide"),n.innerHTML="<th>Time</th><th>Weather</th><th>Temp</th><th>Wind <span>m/s</span></th><th>Humidity <span>%</span></th>",t.appendChild(n),e.forEach((e=>{const n=document.createElement("tr");n.innerHTML=`<td>${e.time}</td><td><img src="${e.weatherIcon}" alt="${e.weatherDescription}"></td><td>${e.temp}&#176</td><td>${e.wind}</td><td>${e.humidity}</td>`,t.appendChild(n)})),t})(e.intervals);t.append(n,i),n.addEventListener("click",(()=>{i.classList.toggle("hide"),c.classList.toggle("fa-chevron-down"),c.classList.toggle("fa-chevron-up")}))})),document.querySelector(".loader-container").style.display="none"})(i)}catch(e){throw e}})),s=(e,r)=>{let c,i=[],s=n(e[0].dt,r),d=[],l=0,u=0;for(let m=0;m<e.length;m++){const h=n(e[m].dt,r);let p;p=m!==e.length-1?n(e[m+1].dt,r):"",0!==m&&s===h||(s=h,l=e[m].main.temp,u=e[m].main.temp),l>e[m].main.temp&&(l=e[m].main.temp),u<e[m].main.temp&&(u=e[m].main.temp);const w={time:t(e[m].dt,r),weatherIcon:`http://openweathermap.org/img/wn/${e[m].weather[0].icon}@2x.png`,weatherDescription:e[m].weather[0].description,temp:a(e[m].main.temp),wind:e[m].wind.speed,humidity:e[m].main.humidity};if(d.push(w),m===e.length-1||s!==p){const t=d.length,n=Math.round(t/2)-1;c={date:h,weekday:o(e[m].dt,r),weatherIcon:d[n].weatherIcon,weatherDescription:d[n].weatherDescription,minTemp:a(l),maxTemp:a(u),intervals:d},i.push(c),d=[]}}return i};const d=document.querySelector("#citySearch");d.addEventListener("input",(()=>{m(u(d.value),d.value.length)}));let l=[];const u=e=>{let t=[];return e.length<1||(t=l.filter((t=>t.name.toLowerCase().startsWith(e.toLowerCase()))),t.sort(((e,t)=>e.name>t.name?1:-1))),t},m=(e,t)=>{let n=document.querySelector("#filteredCities");n.textContent="",e.forEach((e=>{const o=document.createElement("div"),a=`${e.name}, ${e.country}`;let r="";t&&t>0&&(r=`<b>${a.substring(0,t)}</b>${a.substring(t)}</b>`),o.innerHTML=r,o.classList.add("resultItem"),o.addEventListener("click",(()=>{const{lat:t,lon:o}=e.coord;d.value="",n.textContent="",c(t,o),i(t,o)})),n.appendChild(o)}))},h=59.334591,p=18.06324,w={enableHighAccuracy:!0,timeout:5e3,maximumAge:0},y=e=>{const{latitude:t,longitude:n}=e.coords;c(t,n),i(t,n)};function v(e){switch(c(h,p),i(h,p),e.code){case e.PERMISSION_DENIED:console.log("User denied the request for Geolocation.");break;case e.POSITION_UNAVAILABLE:console.log("Location information is unavailable.");break;case e.TIMEOUT:console.log("The request to get user location timed out.");break;default:console.log("An unknown error occurred.")}}var f,g;g=function*(){var e,t,n,o;navigator.geolocation?navigator.geolocation.getCurrentPosition(y,v,w):(alert("Geolocation is not supported by this browser."),c(h,p),i(h,p)),yield(e=void 0,t=void 0,n=void 0,o=function*(){const e=yield fetch("../../city.list.json"),t=yield e.json();l=t},new(n||(n=Promise))((function(a,r){function c(e){try{s(o.next(e))}catch(e){r(e)}}function i(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((o=o.apply(e,t||[])).next())})))},new((f=void 0)||(f=Promise))((function(e,t){function n(e){try{a(g.next(e))}catch(e){t(e)}}function o(e){try{a(g.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof f?a:new f((function(e){e(a)}))).then(n,o)}a((g=g.apply(void 0,[])).next())}))})();